(()=>{var tt={index:"/search.json"};function A(e){return Array.isArray?Array.isArray(e):at(e)==="[object Array]"}var ft=1/0;function pt(e){return e==null?"":function(t){if(typeof t=="string")return t;let n=t+"";return n=="0"&&1/t==-ft?"-0":n}(e)}function E(e){return typeof e=="string"}function ot(e){return typeof e=="number"}function mt(e){return e===!0||e===!1||function(t){return ht(t)&&t!==null}(e)&&at(e)=="[object Boolean]"}function ht(e){return typeof e=="object"}function k(e){return e!=null}function T(e){return!e.trim().length}function at(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Mt=e=>`Missing ${e} property in key`,xt=e=>`Property 'weight' in key '${e}' must be a positive integer`,et=Object.prototype.hasOwnProperty,V=class{constructor(t){this._keys=[],this._keyMap={};let n=0;t.forEach(s=>{let i=lt(s);this._keys.push(i),this._keyMap[i.id]=i,n+=i.weight}),this._keys.forEach(s=>{s.weight/=n})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function lt(e){let t=null,n=null,s=null,i=1,r=null;if(E(e)||A(e))s=e,t=nt(e),n=Q(e);else{if(!et.call(e,"name"))throw new Error(Mt("name"));let c=e.name;if(s=c,et.call(e,"weight")&&(i=e.weight,i<=0))throw new Error(xt(c));t=nt(c),n=Q(c),r=e.getFn}return{path:t,id:n,weight:i,src:s,getFn:r}}function nt(e){return A(e)?e:e.split(".")}function Q(e){return A(e)?e.join("."):e}var u={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,useExtendedSearch:!1,getFn:function(e,t){let n=[],s=!1,i=(r,c,h)=>{if(k(r))if(c[h]){let o=r[c[h]];if(!k(o))return;if(h===c.length-1&&(E(o)||ot(o)||mt(o)))n.push(pt(o));else if(A(o)){s=!0;for(let l=0,a=o.length;l<a;l+=1)i(o[l],c,h+1)}else c.length&&i(o,c,h+1)}else n.push(r)};return i(e,E(t)?t.split("."):t,0),s?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},yt=/[^ ]+/g,z=class{constructor({getFn:t=u.getFn,fieldNormWeight:n=u.fieldNormWeight}={}){this.norm=function(s=1,i=3){let r=new Map,c=Math.pow(10,i);return{get(h){let o=h.match(yt).length;if(r.has(o))return r.get(o);let l=1/Math.pow(o,.5*s),a=parseFloat(Math.round(l*c)/c);return r.set(o,a),a},clear(){r.clear()}}}(n,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((n,s)=>{this._keysMap[n.id]=s})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,E(this.docs[0])?this.docs.forEach((t,n)=>{this._addString(t,n)}):this.docs.forEach((t,n)=>{this._addObject(t,n)}),this.norm.clear())}add(t){let n=this.size();E(t)?this._addString(t,n):this._addObject(t,n)}removeAt(t){this.records.splice(t,1);for(let n=t,s=this.size();n<s;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(t,n){return t[this._keysMap[n]]}size(){return this.records.length}_addString(t,n){if(!k(t)||T(t))return;let s={v:t,i:n,n:this.norm.get(t)};this.records.push(s)}_addObject(t,n){let s={i:n,$:{}};this.keys.forEach((i,r)=>{let c=i.getFn?i.getFn(t):this.getFn(t,i.path);if(k(c)){if(A(c)){let h=[],o=[{nestedArrIndex:-1,value:c}];for(;o.length;){let{nestedArrIndex:l,value:a}=o.pop();if(k(a))if(E(a)&&!T(a)){let d={v:a,i:l,n:this.norm.get(a)};h.push(d)}else A(a)&&a.forEach((d,g)=>{o.push({nestedArrIndex:g,value:d})})}s.$[r]=h}else if(E(c)&&!T(c)){let h={v:c,n:this.norm.get(c)};s.$[r]=h}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}};function ut(e,t,{getFn:n=u.getFn,fieldNormWeight:s=u.fieldNormWeight}={}){let i=new z({getFn:n,fieldNormWeight:s});return i.setKeys(e.map(lt)),i.setSources(t),i.create(),i}function q(e,{errors:t=0,currentLocation:n=0,expectedLocation:s=0,distance:i=u.distance,ignoreLocation:r=u.ignoreLocation}={}){let c=t/e.length;if(r)return c;let h=Math.abs(s-n);return i?c+h/i:h?1:c}var R=32;function Lt(e,t,n,{location:s=u.location,distance:i=u.distance,threshold:r=u.threshold,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,includeMatches:o=u.includeMatches,ignoreLocation:l=u.ignoreLocation}={}){if(t.length>R)throw new Error(`Pattern length exceeds max of ${R}.`);let a=t.length,d=e.length,g=Math.max(0,Math.min(s,d)),f=r,p=g,m=h>1||o,x=m?Array(d):[],y;for(;(y=e.indexOf(t,p))>-1;){let v=q(t,{currentLocation:y,expectedLocation:g,distance:i,ignoreLocation:l});if(f=Math.min(v,f),p=y+a,m){let S=0;for(;S<a;)x[y+S]=1,S+=1}}p=-1;let $=[],L=1,C=a+d,N=1<<a-1;for(let v=0;v<a;v+=1){let S=0,w=C;for(;S<w;)q(t,{errors:v,currentLocation:g+w,expectedLocation:g,distance:i,ignoreLocation:l})<=f?S=w:C=w,w=Math.floor((C-S)/2+S);C=w;let j=Math.max(1,g-w+1),_=c?d:Math.min(g+w,d)+a,I=Array(_+2);I[_+1]=(1<<v)-1;for(let M=_;M>=j;M-=1){let O=M-1,W=n[e.charAt(O)];if(m&&(x[O]=+!!W),I[M]=(I[M+1]<<1|1)&W,v&&(I[M]|=($[M+1]|$[M])<<1|1|$[M+1]),I[M]&N&&(L=q(t,{errors:v,currentLocation:O,expectedLocation:g,distance:i,ignoreLocation:l}),L<=f)){if(f=L,p=O,p<=g)break;j=Math.max(1,2*g-p)}}if(q(t,{errors:v+1,currentLocation:g,expectedLocation:g,distance:i,ignoreLocation:l})>f)break;$=I}let H={isMatch:p>=0,score:Math.max(.001,L)};if(m){let v=function(S=[],w=u.minMatchCharLength){let j=[],_=-1,I=-1,M=0;for(let O=S.length;M<O;M+=1){let W=S[M];W&&_===-1?_=M:W||_===-1||(I=M-1,I-_+1>=w&&j.push([_,I]),_=-1)}return S[M-1]&&M-_>=w&&j.push([_,M-1]),j}(x,h);v.length?o&&(H.indices=v):H.isMatch=!1}return H}function kt(e){let t={};for(let n=0,s=e.length;n<s;n+=1){let i=e.charAt(n);t[i]=(t[i]||0)|1<<s-n-1}return t}var K=class{constructor(t,{location:n=u.location,threshold:s=u.threshold,distance:i=u.distance,includeMatches:r=u.includeMatches,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,isCaseSensitive:o=u.isCaseSensitive,ignoreLocation:l=u.ignoreLocation}={}){if(this.options={location:n,threshold:s,distance:i,includeMatches:r,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:o,ignoreLocation:l},this.pattern=o?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;let a=(g,f)=>{this.chunks.push({pattern:g,alphabet:kt(g),startIndex:f})},d=this.pattern.length;if(d>R){let g=0,f=d%R,p=d-f;for(;g<p;)a(this.pattern.substr(g,R),g),g+=R;if(f){let m=d-R;a(this.pattern.substr(m),m)}}else a(this.pattern,0)}searchIn(t){let{isCaseSensitive:n,includeMatches:s}=this.options;if(n||(t=t.toLowerCase()),this.pattern===t){let p={isMatch:!0,score:0};return s&&(p.indices=[[0,t.length-1]]),p}let{location:i,distance:r,threshold:c,findAllMatches:h,minMatchCharLength:o,ignoreLocation:l}=this.options,a=[],d=0,g=!1;this.chunks.forEach(({pattern:p,alphabet:m,startIndex:x})=>{let{isMatch:y,score:$,indices:L}=Lt(t,p,m,{location:i+x,distance:r,threshold:c,findAllMatches:h,minMatchCharLength:o,includeMatches:s,ignoreLocation:l});y&&(g=!0),d+=$,y&&L&&(a=[...a,...L])});let f={isMatch:g,score:g?d/this.chunks.length:1};return g&&s&&(f.indices=a),f}},b=class{constructor(t){this.pattern=t}static isMultiMatch(t){return st(t,this.multiRegex)}static isSingleMatch(t){return st(t,this.singleRegex)}search(){}};function st(e,t){let n=e.match(t);return n?n[1]:null}var P=class extends b{constructor(t,{location:n=u.location,threshold:s=u.threshold,distance:i=u.distance,includeMatches:r=u.includeMatches,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,isCaseSensitive:o=u.isCaseSensitive,ignoreLocation:l=u.ignoreLocation}={}){super(t),this._bitapSearch=new K(t,{location:n,threshold:s,distance:i,includeMatches:r,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:o,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},J=class extends b{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let n,s=0,i=[],r=this.pattern.length;for(;(n=t.indexOf(this.pattern,s))>-1;)s=n+r,i.push([n,s-1]);let c=!!i.length;return{isMatch:c,score:c?0:1,indices:i}}},G=[class extends b{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},J,class extends b{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},class extends b{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends b{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},class extends b{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},class extends b{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let t=e.indexOf(this.pattern)===-1;return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},P],it=G.length,vt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,St=new Set([P.type,J.type]),X=class{constructor(t,{isCaseSensitive:n=u.isCaseSensitive,includeMatches:s=u.includeMatches,minMatchCharLength:i=u.minMatchCharLength,ignoreLocation:r=u.ignoreLocation,findAllMatches:c=u.findAllMatches,location:h=u.location,threshold:o=u.threshold,distance:l=u.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:s,minMatchCharLength:i,findAllMatches:c,ignoreLocation:r,location:h,threshold:o,distance:l},this.pattern=n?t:t.toLowerCase(),this.query=function(a,d={}){return a.split("|").map(g=>{let f=g.trim().split(vt).filter(m=>m&&!!m.trim()),p=[];for(let m=0,x=f.length;m<x;m+=1){let y=f[m],$=!1,L=-1;for(;!$&&++L<it;){let C=G[L],N=C.isMultiMatch(y);N&&(p.push(new C(N,d)),$=!0)}if(!$)for(L=-1;++L<it;){let C=G[L],N=C.isSingleMatch(y);if(N){p.push(new C(N,d));break}}}return p})}(this.pattern,this.options)}static condition(t,n){return n.useExtendedSearch}searchIn(t){let n=this.query;if(!n)return{isMatch:!1,score:1};let{includeMatches:s,isCaseSensitive:i}=this.options;t=i?t:t.toLowerCase();let r=0,c=[],h=0;for(let o=0,l=n.length;o<l;o+=1){let a=n[o];c.length=0,r=0;for(let d=0,g=a.length;d<g;d+=1){let f=a[d],{isMatch:p,indices:m,score:x}=f.search(t);if(!p){h=0,r=0,c.length=0;break}if(r+=1,h+=x,s){let y=f.constructor.type;St.has(y)?c=[...c,...m]:c.push(m)}}if(r){let d={isMatch:!0,score:h/r};return s&&(d.indices=c),d}}return{isMatch:!1,score:1}}},Y=[];function Z(e,t){for(let n=0,s=Y.length;n<s;n+=1){let i=Y[n];if(i.condition(e,t))return new i(e,t)}return new K(e,t)}var D="$and",_t="$or",rt="$path",wt="$val",U=e=>!(!e[D]&&!e[_t]),ct=e=>({[D]:Object.keys(e).map(t=>({[t]:e[t]}))});function $t(e,t,{auto:n=!0}={}){let s=i=>{let r=Object.keys(i),c=(o=>!!o[rt])(i);if(!c&&r.length>1&&!U(i))return s(ct(i));if((o=>!A(o)&&ht(o)&&!U(o))(i)){let o=c?i[rt]:r[0],l=c?i[wt]:i[o];if(!E(l))throw new Error((d=>`Invalid value for key ${d}`)(o));let a={keyId:Q(o),pattern:l};return n&&(a.searcher=Z(l,t)),a}let h={children:[],operator:r[0]};return r.forEach(o=>{let l=i[o];A(l)&&l.forEach(a=>{h.children.push(s(a))})}),h};return U(e)||(e=ct(e)),s(e)}function Ct(e,t){let n=e.matches;t.matches=[],k(n)&&n.forEach(s=>{if(!k(s.indices)||!s.indices.length)return;let{indices:i,value:r}=s,c={indices:i,value:r};s.key&&(c.key=s.key.src),s.idx>-1&&(c.refIndex=s.idx),t.matches.push(c)})}function It(e,t){t.score=e.score}var F=class{constructor(t,n={},s){this.options={...u,...n},this.options.useExtendedSearch,this._keyStore=new V(this.options.keys),this.setCollection(t,s)}setCollection(t,n){if(this._docs=t,n&&!(n instanceof z))throw new Error("Incorrect 'index' type");this._myIndex=n||ut(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){k(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){let n=[];for(let s=0,i=this._docs.length;s<i;s+=1){let r=this._docs[s];t(r,s)&&(this.removeAt(s),s-=1,i-=1,n.push(r))}return n}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:n=-1}={}){let{includeMatches:s,includeScore:i,shouldSort:r,sortFn:c,ignoreFieldNorm:h}=this.options,o=E(t)?E(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(l,{ignoreFieldNorm:a=u.ignoreFieldNorm}){l.forEach(d=>{let g=1;d.matches.forEach(({key:f,norm:p,score:m})=>{let x=f?f.weight:null;g*=Math.pow(m===0&&x?Number.EPSILON:m,(x||1)*(a?1:p))}),d.score=g})}(o,{ignoreFieldNorm:h}),r&&o.sort(c),ot(n)&&n>-1&&(o=o.slice(0,n)),function(l,a,{includeMatches:d=u.includeMatches,includeScore:g=u.includeScore}={}){let f=[];return d&&f.push(Ct),g&&f.push(It),l.map(p=>{let{idx:m}=p,x={item:a[m],refIndex:m};return f.length&&f.forEach(y=>{y(p,x)}),x})}(o,this._docs,{includeMatches:s,includeScore:i})}_searchStringList(t){let n=Z(t,this.options),{records:s}=this._myIndex,i=[];return s.forEach(({v:r,i:c,n:h})=>{if(!k(r))return;let{isMatch:o,score:l,indices:a}=n.searchIn(r);o&&i.push({item:r,idx:c,matches:[{score:l,value:r,norm:h,indices:a}]})}),i}_searchLogical(t){let n=$t(t,this.options),s=(h,o,l)=>{if(!h.children){let{keyId:d,searcher:g}=h,f=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(o,d),searcher:g});return f&&f.length?[{idx:l,item:o,matches:f}]:[]}let a=[];for(let d=0,g=h.children.length;d<g;d+=1){let f=h.children[d],p=s(f,o,l);if(p.length)a.push(...p);else if(h.operator===D)return[]}return a},i=this._myIndex.records,r={},c=[];return i.forEach(({$:h,i:o})=>{if(k(h)){let l=s(n,h,o);l.length&&(r[o]||(r[o]={idx:o,item:h,matches:[]},c.push(r[o])),l.forEach(({matches:a})=>{r[o].matches.push(...a)}))}}),c}_searchObjectList(t){let n=Z(t,this.options),{keys:s,records:i}=this._myIndex,r=[];return i.forEach(({$:c,i:h})=>{if(!k(c))return;let o=[];s.forEach((l,a)=>{o.push(...this._findMatches({key:l,value:c[a],searcher:n}))}),o.length&&r.push({idx:h,item:c,matches:o})}),r}_findMatches({key:t,value:n,searcher:s}){if(!k(n))return[];let i=[];if(A(n))n.forEach(({v:r,i:c,n:h})=>{if(!k(r))return;let{isMatch:o,score:l,indices:a}=s.searchIn(r);o&&i.push({score:l,key:t,value:r,idx:c,norm:h,indices:a})});else{let{v:r,n:c}=n,{isMatch:h,score:o,indices:l}=s.searchIn(r);h&&i.push({score:o,key:t,value:r,norm:c,indices:l})}return i}};F.version="7.0.0",F.createIndex=ut,F.parseIndex=function(e,{getFn:t=u.getFn,fieldNormWeight:n=u.fieldNormWeight}={}){let{keys:s,records:i}=e,r=new z({getFn:t,fieldNormWeight:n});return r.setKeys(s),r.setIndexRecords(i),r},F.config=u,function(...e){Y.push(...e)}(X);var B=new URLSearchParams(window.location.search).get("q")||"",dt=document.getElementById("search-form").querySelector("input");dt&&(dt.value=B);var bt={minMatchCharLength:B.length-1,threshold:.2,ignoreLocation:!0,includeMatches:!0,useExtendedSearch:!0,keys:[{name:"content",weight:100},{name:"title",weight:10},{name:"tags",weight:2},{name:"type",weight:1}]};fetch(tt.index).then(e=>e.json()).then(Et).then(At);function Et(e){return new F(e,bt).search(B)}function At(e){let t=document.querySelector("main article");t.innerHTML=e.map(Ft).join(`
`)||`<p>Not found "${B}"</p>`}function Ft(e){let n=structuredClone(e.item.tags)||[],s=e.item;s.content="";for(let r of e.matches){let c=r.indices.reduceRight((h,o)=>Nt(h,o),r.value);if(r.key==="content"&&c.length>400){let h=Math.max(r.indices[0][0]-10,0);c=c.substr(h,400)+"&hellip;"}r.key==="tags"?s.tags[r.refIndex]=c:s[r.key]=c}n=n.map((r,c)=>`<div><a href="/tags/${r}">${s.tags[c]}</a></div>`);let i=n.join(" ");return`<div>
  <header>
    <h1><a href="${s.href}">${s.type}/${s.title}</a></h1>
    <nav class="tags">${i}</nav>
  </header>
  <p>${s.content}</p>
</div>`}function Nt(e,t){let n=t[1]+1,s="<mark>"+e.substring(t[0],n)+"</mark>";return e.substring(0,t[0])+s+e.substring(n)}})();

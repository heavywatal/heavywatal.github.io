(()=>{var Z={index:"/search.json"};function A(t){return Array.isArray?Array.isArray(t):he(t)==="[object Array]"}function E(t){return typeof t=="string"}function ce(t){return typeof t=="number"}function ge(t){return t===!0||t===!1||function(e){return oe(e)&&e!==null}(t)&&he(t)=="[object Boolean]"}function oe(t){return typeof t=="object"}function k(t){return t!=null}function T(t){return!t.trim().length}function he(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var ee=Object.prototype.hasOwnProperty,U=class{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(s=>{let i=ae(s);n+=i.weight,this._keys.push(i),this._keyMap[i.id]=i,n+=i.weight}),this._keys.forEach(s=>{s.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function ae(t){let e=null,n=null,s=null,i=1,r=null;if(E(t)||A(t))s=t,e=te(t),n=V(t);else{if(!ee.call(t,"name"))throw new Error((h=>`Missing ${h} property in key`)("name"));let c=t.name;if(s=c,ee.call(t,"weight")&&(i=t.weight,i<=0))throw new Error((h=>`Property 'weight' in key '${h}' must be a positive integer`)(c));e=te(c),n=V(c),r=t.getFn}return{path:e,id:n,weight:i,src:s,getFn:r}}function te(t){return A(t)?t:t.split(".")}function V(t){return A(t)?t.join("."):t}var u={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,useExtendedSearch:!1,getFn:function(t,e){let n=[],s=!1,i=(r,c,h)=>{if(k(r))if(c[h]){let o=r[c[h]];if(!k(o))return;if(h===c.length-1&&(E(o)||ce(o)||ge(o)))n.push(function(l){return l==null?"":function(a){if(typeof a=="string")return a;let d=a+"";return d=="0"&&1/a==-1/0?"-0":d}(l)}(o));else if(A(o)){s=!0;for(let l=0,a=o.length;l<a;l+=1)i(o[l],c,h+1)}else c.length&&i(o,c,h+1)}else n.push(r)};return i(t,E(e)?e.split("."):e,0),s?n:n[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},fe=/[^ ]+/g,W=class{constructor({getFn:e=u.getFn,fieldNormWeight:n=u.fieldNormWeight}={}){this.norm=function(s=1,i=3){let r=new Map,c=Math.pow(10,i);return{get(h){let o=h.match(fe).length;if(r.has(o))return r.get(o);let l=1/Math.pow(o,.5*s),a=parseFloat(Math.round(l*c)/c);return r.set(o,a),a},clear(){r.clear()}}}(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,s)=>{this._keysMap[n.id]=s})}create(){!this.isCreated&&this.docs.length&&(this.isCreated=!0,E(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){let n=this.size();E(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,s=this.size();n<s;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!k(e)||T(e))return;let s={v:e,i:n,n:this.norm.get(e)};this.records.push(s)}_addObject(e,n){let s={i:n,$:{}};this.keys.forEach((i,r)=>{let c=i.getFn?i.getFn(e):this.getFn(e,i.path);if(k(c)){if(A(c)){let h=[],o=[{nestedArrIndex:-1,value:c}];for(;o.length;){let{nestedArrIndex:l,value:a}=o.pop();if(k(a))if(E(a)&&!T(a)){let d={v:a,i:l,n:this.norm.get(a)};h.push(d)}else A(a)&&a.forEach((d,g)=>{o.push({nestedArrIndex:g,value:d})})}s.$[r]=h}else if(E(c)&&!T(c)){let h={v:c,n:this.norm.get(c)};s.$[r]=h}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}};function le(t,e,{getFn:n=u.getFn,fieldNormWeight:s=u.fieldNormWeight}={}){let i=new W({getFn:n,fieldNormWeight:s});return i.setKeys(t.map(ae)),i.setSources(e),i.create(),i}function z(t,{errors:e=0,currentLocation:n=0,expectedLocation:s=0,distance:i=u.distance,ignoreLocation:r=u.ignoreLocation}={}){let c=e/t.length;if(r)return c;let h=Math.abs(s-n);return i?c+h/i:h?1:c}function pe(t,e,n,{location:s=u.location,distance:i=u.distance,threshold:r=u.threshold,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,includeMatches:o=u.includeMatches,ignoreLocation:l=u.ignoreLocation}={}){if(e.length>32)throw new Error("Pattern length exceeds max of 32.");let a=e.length,d=t.length,g=Math.max(0,Math.min(s,d)),f=r,p=g,m=h>1||o,y=m?Array(d):[],x;for(;(x=t.indexOf(e,p))>-1;){let v=z(e,{currentLocation:x,expectedLocation:g,distance:i,ignoreLocation:l});if(f=Math.min(v,f),p=x+a,m){let S=0;for(;S<a;)y[x+S]=1,S+=1}}p=-1;let $=[],L=1,I=a+d,N=1<<a-1;for(let v=0;v<a;v+=1){let S=0,w=I;for(;S<w;)z(e,{errors:v,currentLocation:g+w,expectedLocation:g,distance:i,ignoreLocation:l})<=f?S=w:I=w,w=Math.floor((I-S)/2+S);I=w;let R=Math.max(1,g-w+1),_=c?d:Math.min(g+w,d)+a,C=Array(_+2);C[_+1]=(1<<v)-1;for(let M=_;M>=R;M-=1){let j=M-1,O=n[t.charAt(j)];if(m&&(y[j]=+!!O),C[M]=(C[M+1]<<1|1)&O,v&&(C[M]|=($[M+1]|$[M])<<1|1|$[M+1]),C[M]&N&&(L=z(e,{errors:v,currentLocation:j,expectedLocation:g,distance:i,ignoreLocation:l}),L<=f)){if(f=L,p=j,p<=g)break;R=Math.max(1,2*g-p)}}if(z(e,{errors:v+1,currentLocation:g,expectedLocation:g,distance:i,ignoreLocation:l})>f)break;$=C}let J={isMatch:p>=0,score:Math.max(.001,L)};if(m){let v=function(S=[],w=u.minMatchCharLength){let R=[],_=-1,C=-1,M=0;for(let j=S.length;M<j;M+=1){let O=S[M];O&&_===-1?_=M:O||_===-1||(C=M-1,C-_+1>=w&&R.push([_,C]),_=-1)}return S[M-1]&&M-_>=w&&R.push([_,M-1]),R}(y,h);v.length?o&&(J.indices=v):J.isMatch=!1}return J}function me(t){let e={};for(let n=0,s=t.length;n<s;n+=1){let i=t.charAt(n);e[i]=(e[i]||0)|1<<s-n-1}return e}var K=class{constructor(e,{location:n=u.location,threshold:s=u.threshold,distance:i=u.distance,includeMatches:r=u.includeMatches,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,isCaseSensitive:o=u.isCaseSensitive,ignoreLocation:l=u.ignoreLocation}={}){if(this.options={location:n,threshold:s,distance:i,includeMatches:r,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:o,ignoreLocation:l},this.pattern=o?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;let a=(g,f)=>{this.chunks.push({pattern:g,alphabet:me(g),startIndex:f})},d=this.pattern.length;if(d>32){let g=0,f=d%32,p=d-f;for(;g<p;)a(this.pattern.substr(g,32),g),g+=32;if(f){let m=d-32;a(this.pattern.substr(m),m)}}else a(this.pattern,0)}searchIn(e){let{isCaseSensitive:n,includeMatches:s}=this.options;if(n||(e=e.toLowerCase()),this.pattern===e){let p={isMatch:!0,score:0};return s&&(p.indices=[[0,e.length-1]]),p}let{location:i,distance:r,threshold:c,findAllMatches:h,minMatchCharLength:o,ignoreLocation:l}=this.options,a=[],d=0,g=!1;this.chunks.forEach(({pattern:p,alphabet:m,startIndex:y})=>{let{isMatch:x,score:$,indices:L}=pe(e,p,m,{location:i+y,distance:r,threshold:c,findAllMatches:h,minMatchCharLength:o,includeMatches:s,ignoreLocation:l});x&&(g=!0),d+=$,x&&L&&(a=[...a,...L])});let f={isMatch:g,score:g?d/this.chunks.length:1};return g&&s&&(f.indices=a),f}},b=class{constructor(e){this.pattern=e}static isMultiMatch(e){return ne(e,this.multiRegex)}static isSingleMatch(e){return ne(e,this.singleRegex)}search(){}};function ne(t,e){let n=t.match(e);return n?n[1]:null}var P=class extends b{constructor(e,{location:n=u.location,threshold:s=u.threshold,distance:i=u.distance,includeMatches:r=u.includeMatches,findAllMatches:c=u.findAllMatches,minMatchCharLength:h=u.minMatchCharLength,isCaseSensitive:o=u.isCaseSensitive,ignoreLocation:l=u.ignoreLocation}={}){super(e),this._bitapSearch=new K(e,{location:n,threshold:s,distance:i,includeMatches:r,findAllMatches:c,minMatchCharLength:h,isCaseSensitive:o,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},q=class extends b{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n,s=0,i=[],r=this.pattern.length;for(;(n=e.indexOf(this.pattern,s))>-1;)s=n+r,i.push([n,s-1]);let c=!!i.length;return{isMatch:c,score:c?0:1,indices:i}}},Q=[class extends b{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){let e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},q,class extends b{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){let e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}},class extends b{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){let e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends b{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){let e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},class extends b{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){let e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},class extends b{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){let e=t.indexOf(this.pattern)===-1;return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}},P],se=Q.length,Me=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ye=new Set([P.type,q.type]),D=class{constructor(e,{isCaseSensitive:n=u.isCaseSensitive,includeMatches:s=u.includeMatches,minMatchCharLength:i=u.minMatchCharLength,ignoreLocation:r=u.ignoreLocation,findAllMatches:c=u.findAllMatches,location:h=u.location,threshold:o=u.threshold,distance:l=u.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:s,minMatchCharLength:i,findAllMatches:c,ignoreLocation:r,location:h,threshold:o,distance:l},this.pattern=n?e:e.toLowerCase(),this.query=function(a,d={}){return a.split("|").map(g=>{let f=g.trim().split(Me).filter(m=>m&&!!m.trim()),p=[];for(let m=0,y=f.length;m<y;m+=1){let x=f[m],$=!1,L=-1;for(;!$&&++L<se;){let I=Q[L],N=I.isMultiMatch(x);N&&(p.push(new I(N,d)),$=!0)}if(!$)for(L=-1;++L<se;){let I=Q[L],N=I.isSingleMatch(x);if(N){p.push(new I(N,d));break}}}return p})}(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){let n=this.query;if(!n)return{isMatch:!1,score:1};let{includeMatches:s,isCaseSensitive:i}=this.options;e=i?e:e.toLowerCase();let r=0,c=[],h=0;for(let o=0,l=n.length;o<l;o+=1){let a=n[o];c.length=0,r=0;for(let d=0,g=a.length;d<g;d+=1){let f=a[d],{isMatch:p,indices:m,score:y}=f.search(e);if(!p){h=0,r=0,c.length=0;break}if(r+=1,h+=y,s){let x=f.constructor.type;ye.has(x)?c=[...c,...m]:c.push(m)}}if(r){let d={isMatch:!0,score:h/r};return s&&(d.indices=c),d}}return{isMatch:!1,score:1}}},G=[];function X(t,e){for(let n=0,s=G.length;n<s;n+=1){let i=G[n];if(i.condition(t,e))return new i(t,e)}return new K(t,e)}var Y="$and",xe="$or",ie="$path",Le="$val",B=t=>!(!t[Y]&&!t[xe]),re=t=>({[Y]:Object.keys(t).map(e=>({[e]:t[e]}))});function ke(t,e,{auto:n=!0}={}){let s=i=>{let r=Object.keys(i),c=(o=>!!o[ie])(i);if(!c&&r.length>1&&!B(i))return s(re(i));if((o=>!A(o)&&oe(o)&&!B(o))(i)){let o=c?i[ie]:r[0],l=c?i[Le]:i[o];if(!E(l))throw new Error((d=>`Invalid value for key ${d}`)(o));let a={keyId:V(o),pattern:l};return n&&(a.searcher=X(l,e)),a}let h={children:[],operator:r[0]};return r.forEach(o=>{let l=i[o];A(l)&&l.forEach(a=>{h.children.push(s(a))})}),h};return B(t)||(t=re(t)),s(t)}function ve(t,e){let n=t.matches;e.matches=[],k(n)&&n.forEach(s=>{if(!k(s.indices)||!s.indices.length)return;let{indices:i,value:r}=s,c={indices:i,value:r};s.key&&(c.key=s.key.src),s.idx>-1&&(c.refIndex=s.idx),e.matches.push(c)})}function Se(t,e){e.score=t.score}var F=class{constructor(e,n={},s){this.options={...u,...n},this.options.useExtendedSearch,this._keyStore=new U(this.options.keys),this.setCollection(e,s)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof W))throw new Error("Incorrect 'index' type");this._myIndex=n||le(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){k(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let n=[];for(let s=0,i=this._docs.length;s<i;s+=1){let r=this._docs[s];e(r,s)&&(this.removeAt(s),s-=1,i-=1,n.push(r))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){let{includeMatches:s,includeScore:i,shouldSort:r,sortFn:c,ignoreFieldNorm:h}=this.options,o=E(e)?E(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return function(l,{ignoreFieldNorm:a=u.ignoreFieldNorm}){l.forEach(d=>{let g=1;d.matches.forEach(({key:f,norm:p,score:m})=>{let y=f?f.weight:null;g*=Math.pow(m===0&&y?Number.EPSILON:m,(y||1)*(a?1:p))}),d.score=g})}(o,{ignoreFieldNorm:h}),r&&o.sort(c),ce(n)&&n>-1&&(o=o.slice(0,n)),function(l,a,{includeMatches:d=u.includeMatches,includeScore:g=u.includeScore}={}){let f=[];return d&&f.push(ve),g&&f.push(Se),l.map(p=>{let{idx:m}=p,y={item:a[m],refIndex:m};return f.length&&f.forEach(x=>{x(p,y)}),y})}(o,this._docs,{includeMatches:s,includeScore:i})}_searchStringList(e){let n=X(e,this.options),{records:s}=this._myIndex,i=[];return s.forEach(({v:r,i:c,n:h})=>{if(!k(r))return;let{isMatch:o,score:l,indices:a}=n.searchIn(r);o&&i.push({item:r,idx:c,matches:[{score:l,value:r,norm:h,indices:a}]})}),i}_searchLogical(e){let n=ke(e,this.options),s=(h,o,l)=>{if(!h.children){let{keyId:d,searcher:g}=h,f=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(o,d),searcher:g});return f&&f.length?[{idx:l,item:o,matches:f}]:[]}let a=[];for(let d=0,g=h.children.length;d<g;d+=1){let f=h.children[d],p=s(f,o,l);if(p.length)a.push(...p);else if(h.operator===Y)return[]}return a},i=this._myIndex.records,r={},c=[];return i.forEach(({$:h,i:o})=>{if(k(h)){let l=s(n,h,o);l.length&&(r[o]||(r[o]={idx:o,item:h,matches:[]},c.push(r[o])),l.forEach(({matches:a})=>{r[o].matches.push(...a)}))}}),c}_searchObjectList(e){let n=X(e,this.options),{keys:s,records:i}=this._myIndex,r=[];return i.forEach(({$:c,i:h})=>{if(!k(c))return;let o=[];s.forEach((l,a)=>{o.push(...this._findMatches({key:l,value:c[a],searcher:n}))}),o.length&&r.push({idx:h,item:c,matches:o})}),r}_findMatches({key:e,value:n,searcher:s}){if(!k(n))return[];let i=[];if(A(n))n.forEach(({v:r,i:c,n:h})=>{if(!k(r))return;let{isMatch:o,score:l,indices:a}=s.searchIn(r);o&&i.push({score:l,key:e,value:r,idx:c,norm:h,indices:a})});else{let{v:r,n:c}=n,{isMatch:h,score:o,indices:l}=s.searchIn(r);h&&i.push({score:o,key:e,value:r,norm:c,indices:l})}return i}};F.version="6.6.2",F.createIndex=le,F.parseIndex=function(t,{getFn:e=u.getFn,fieldNormWeight:n=u.fieldNormWeight}={}){let{keys:s,records:i}=t,r=new W({getFn:e,fieldNormWeight:n});return r.setKeys(s),r.setIndexRecords(i),r},F.config=u,function(...t){G.push(...t)}(D);var H=new URLSearchParams(window.location.search).get("q")||"",ue=document.getElementById("search-form").querySelector("input");ue&&(ue.value=H);var _e={minMatchCharLength:H.length-1,threshold:.2,ignoreLocation:!0,includeMatches:!0,useExtendedSearch:!0,keys:[{name:"content",weight:100},{name:"title",weight:10},{name:"tags",weight:2},{name:"type",weight:1}]};fetch(Z.index).then(t=>t.json()).then(we).then($e);function we(t){return new F(t,_e).search(H)}function $e(t){let e=document.querySelector("main article");e.innerHTML=t.map(Ie).join(`
`)||`<p>Not found "${H}"</p>`}function Ie(t){let n=structuredClone(t.item.tags)||[],s=t.item;s.content="";for(let r of t.matches){let c=r.indices.reduceRight((h,o)=>Ce(h,o),r.value);if(r.key==="content"&&c.length>400){let h=Math.max(r.indices[0][0]-10,0);c=c.substr(h,400)+"&hellip;"}r.key==="tags"?s.tags[r.refIndex]=c:s[r.key]=c}n=n.map((r,c)=>`<div><a href="/tags/${r}">${s.tags[c]}</a></div>`);let i=n.join(" ");return`<div>
  <header>
    <h1><a href="${s.href}">${s.type}/${s.title}</a></h1>
    <nav class="tags">${i}</nav>
  </header>
  <p>${s.content}</p>
</div>`}function Ce(t,e){let n=e[1]+1,s="<mark>"+t.substring(e[0],n)+"</mark>";return t.substring(0,e[0])+s+t.substring(n)}})();

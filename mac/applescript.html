<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.16-DEV" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/students/iwasaki/css/theme.css">
<link rel="stylesheet" href="/students/iwasaki/css/highlight.css">
<link rel="shortcut icon" href="/students/iwasaki/favicon.ico">
<link rel="icon" href="/students/iwasaki/favicon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="/students/iwasaki/favicon-192x192.png" sizes="192x192">
<title>AppleScript - Watal M. Iwasaki</title>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['$$','$$']],
    processEnvironments: false,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i = 0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.classList.add('has-jax');
  }
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-41178626-1', 'auto');
ga('send', 'pageview');
</script>
</head>
<body><div id="container">
<header><h1><a href="/students/iwasaki/">
<img class="logo" src="/students/iwasaki/favicon-32x32.png" alt="航">
Watal M. Iwasaki
</a></h1>
</header>

<main>
<article>
<header><h1><a href="">
AppleScript
</a></h1>
<ul id="tags">
</ul>
</header>



<h2 id="finder-get-file-path">Finder: Get file path</h2>

<pre><code>tell application &quot;Finder&quot;
    set the clipboard to POSIX path of (the selection as alias)
end tell
</code></pre>

<h2 id="itunes-equalizer">iTunes Equalizer</h2>

<p>イコライザを設定するスクリプト。
<code>band 1</code> が低音で <code>band 10</code> が高音。
下記の設定は Equal-loudness contour(等ラウドネス曲線) を考慮して
小さい音量でもシャカシャカせずそれなりのバランスで聴こえるようにした値。
音量やスピーカや好みによって調整し、別々のスクリプトとして保存しておくとよい:</p>

<pre><code>tell application &quot;iTunes&quot;
        tell EQ preset &quot;Manual&quot;
                set band 1 to 1.5
                set band 2 to 0.7
                set band 3 to 0.3
                set band 4 to 0.1
                set band 5 to -0.1
                set band 6 to -0.5
                set band 7 to -1
                set band 8 to -2
                set band 9 to 0.3
                set band 10 to 0.7
                set preamp to 0
        end tell
end tell
</code></pre>

<h2 id="osascript-スクリプトをターミナルで実行">osascript: スクリプトをターミナルで実行</h2>

<p>スクリプトを置いたディレクトリにパスを通せれば楽なんだけど。できるのかな？:</p>

<pre><code>% osascript ${HOME}/Library/Scripts/Applications/Bibdesk/exportOOXML.scpt
</code></pre>

<h2 id="mi-で選択中の文字列をターミナルで実行">mi で選択中の文字列をターミナルで実行</h2>

<pre><code>tell application &quot;mi&quot;
        tell document 1
                set CommandLines to selection
        end tell
end tell

tell application &quot;Terminal&quot;
        activate
        ignoring application responses
                do script with command CommandLines in window 1
        end ignoring
end tell
</code></pre>

<h2 id="bibdesk-からgroupとtemplateを指定してexport">Bibdesk からGroupとTemplateを指定してExport</h2>

<p>出力先、グループ名、テンプレートを最初の３行で指定し、Exportしたいライブラリを開いた状態で実行:</p>

<pre><code>set theOutFile to POSIX file &quot;/Users/Iwasaki/Presentations/20100118Thesis/items1.xml&quot;
set theGroup to &quot;20100118 Thesis&quot;
set theTemplateName to &quot;OOXML template&quot;

using terms from application &quot;BibDesk&quot;
        tell application &quot;BibDesk&quot;
                set theDoc to first document
                set thePubs to publication of static group theGroup of theDoc
                tell theDoc
                        export for thePubs using template theTemplateName to theOutFile
                end tell
        end tell
end using terms from
</code></pre>

</article>
</main>

<nav id="menu">

<div ><a href="/students/iwasaki/cv.html">Curriculum Vitae</a></div>


<div ><a href="/students/iwasaki/research.html">Research Interests</a></div>


<input type="checkbox" id="R stats">
<label for="R stats">R stats</label>
<ul>
<li><a href="/students/iwasaki/rstats/bioconductor.html">Bioconductor</a></li>
<li><a href="/students/iwasaki/rstats/biomart.html">biomaRt</a></li>
<li><a href="/students/iwasaki/rstats/devtools.html">devtools</a></li>
<li><a href="/students/iwasaki/rstats/dplyr.html">dplyr</a></li>
<li><a href="/students/iwasaki/rstats/edger.html">edgeR</a></li>
<li><a href="/students/iwasaki/rstats/ggbio.html">ggbio</a></li>
<li><a href="/students/iwasaki/rstats/ggplot2.html">ggplot2</a></li>
<li><a href="/students/iwasaki/rstats/plyr.html">plyr</a></li>
<li><a href="/students/iwasaki/rstats/readr.html">readr</a></li>
<li><a href="/students/iwasaki/rstats/reshape2.html">reshape2</a></li>
<li><a href="/students/iwasaki/rstats/rgl.html">rgl</a></li>
<li><a href="/students/iwasaki/rstats/rjags.html">rjags</a></li>
<li><a href="/students/iwasaki/rstats/rtracklayer.html">rtracklayer</a></li>
<li><a href="/students/iwasaki/rstats/stringr.html">stringr</a></li>
<li><a href="/students/iwasaki/rstats/tidyr.html">tidyr</a></li>
<li><a href="/students/iwasaki/rstats/topgo.html">topGO</a></li>
<li><a href="/students/iwasaki/rstats/programming.html">プログラミングTips</a></li>
<li><a href="/students/iwasaki/rstats/config.html">環境設定</a></li>
<li><a href="/students/iwasaki/rstats/intro.html">自学自習のための基礎知識</a></li>
</ul>

<input type="checkbox" id="Python">
<label for="Python">Python</label>
<ul>
<li><a href="/students/iwasaki/python/biopython.html">BioPython</a></li>
<li><a href="/students/iwasaki/python/egglib.html">EggLib</a></li>
<li><a href="/students/iwasaki/python/ipython.html">IPython</a></li>
<li><a href="/students/iwasaki/python/install.html">Installation</a></li>
<li><a href="/students/iwasaki/python/scipy.html">NumPy, SciPy</a></li>
<li><a href="/students/iwasaki/python/pyqt.html">PyQt</a></li>
<li><a href="/students/iwasaki/python/copy.html">copy</a></li>
<li><a href="/students/iwasaki/python/matplotlib.html">matplotlib &#43; seaborn</a></li>
<li><a href="/students/iwasaki/python/pip.html">pip</a></li>
<li><a href="/students/iwasaki/python/rpy2.html">rpy2</a></li>
</ul>

<input type="checkbox" id="C&#43;&#43;">
<label for="C&#43;&#43;">C&#43;&#43;</label>
<ul>
<li><a href="/students/iwasaki/cxx/boost.html">Boost</a></li>
<li><a href="/students/iwasaki/cxx/getopt.html">C&#43;&#43; コマンドライン引数の取得</a></li>
<li><a href="/students/iwasaki/cxx/clang.html">clang / llvm</a></li>
<li><a href="/students/iwasaki/cxx/gcc.html">gcc</a></li>
<li><a href="/students/iwasaki/cxx/speed.html">めざせC&#43;&#43;高速プログラム</a></li>
<li><a href="/students/iwasaki/cxx/random.html">擬似乱数生成器</a></li>
</ul>

<input type="checkbox" id="Biology">
<label for="Biology">Biology</label>
<ul>
<li><a href="/students/iwasaki/bio/blast.html">BLAST</a></li>
<li><a href="/students/iwasaki/bio/dnasp.html">DnaSP</a></li>
<li><a href="/students/iwasaki/bio/emboss.html">EMBOSS</a></li>
<li><a href="/students/iwasaki/bio/ensembl.html">Ensembl</a></li>
<li><a href="/students/iwasaki/bio/gene_ontology.html">Gene Ontology</a></li>
<li><a href="/students/iwasaki/bio/meme.html">MEME</a></li>
<li><a href="/students/iwasaki/bio/mrbayes.html">MrBayes</a></li>
<li><a href="/students/iwasaki/bio/paml.html">PAML</a></li>
<li><a href="/students/iwasaki/bio/popgen.html">Population Genetics</a></li>
<li><a href="/students/iwasaki/bio/repeatmasker.html">RepeatMasker</a></li>
<li><a href="/students/iwasaki/bio/samtools.html">SAMtools</a></li>
<li><a href="/students/iwasaki/bio/stochastic_process.html">Stochastic Process</a></li>
<li><a href="/students/iwasaki/bio/dadi.html">dadi</a></li>
<li><a href="/students/iwasaki/bio/linear_algebra.html">線形代数</a></li>
<li><a href="/students/iwasaki/bio/complexnetwork.html">複雑ネットワーク</a></li>
<li><a href="/students/iwasaki/bio/nig.html">遺伝研スパコン</a></li>
<li><a href="/students/iwasaki/bio/motif.html">配列モチーフ探索</a></li>
</ul>

<input type="checkbox" id="Developer Tools">
<label for="Developer Tools">Developer Tools</label>
<ul>
<li><a href="/students/iwasaki/dev/etc.html">/etc</a></li>
<li><a href="/students/iwasaki/dev/emacs.html">Emacs</a></li>
<li><a href="/students/iwasaki/dev/mercurial.html">Mercurial</a></li>
<li><a href="/students/iwasaki/dev/mysql.html">MySQL</a></li>
<li><a href="/students/iwasaki/dev/qt.html">Qt</a></li>
<li><a href="/students/iwasaki/dev/sh.html">Shell Script</a></li>
<li><a href="/students/iwasaki/dev/torque.html">TORQUE</a></li>
<li><a href="/students/iwasaki/dev/tex.html">TeX</a></li>
<li><a href="/students/iwasaki/dev/autotools.html">autoconf, automake</a></li>
<li><a href="/students/iwasaki/dev/make.html">make</a></li>
<li><a href="/students/iwasaki/dev/mount.html">mount</a></li>
<li><a href="/students/iwasaki/dev/nano.html">nano</a></li>
<li><a href="/students/iwasaki/dev/rsync.html">rsync</a></li>
<li><a href="/students/iwasaki/dev/ssh.html">ssh</a></li>
<li><a href="/students/iwasaki/dev/sshfs.html">sshfs</a></li>
<li><a href="/students/iwasaki/dev/tmux.html">tmux</a></li>
<li><a href="/students/iwasaki/dev/zsh.html">zsh</a></li>
<li><a href="/students/iwasaki/dev/nohup.html">プロセス管理</a></li>
<li><a href="/students/iwasaki/dev/devenv.html">開発環境</a></li>
</ul>

<input type="checkbox" id="Linux">
<label for="Linux">Linux</label>
<ul>
<li><a href="/students/iwasaki/linux/centos.html">CentOS 6.5</a></li>
<li><a href="/students/iwasaki/linux/ufw.html">ufw</a></li>
<li><a href="/students/iwasaki/linux/apt.html">ソフトウェアの管理</a></li>
<li><a href="/students/iwasaki/linux/japanese.html">日本語環境</a></li>
</ul>

<input type="checkbox" id="Mac" checked>
<label for="Mac" class="active">Mac</label>
<ul>
<li class="active"><a href="/students/iwasaki/mac/applescript.html">AppleScript</a></li>
<li><a href="/students/iwasaki/mac/command.html">Command</a></li>
<li><a href="/students/iwasaki/mac/homebrew.html">Homebrew</a></li>
<li><a href="/students/iwasaki/mac/keyboard.html">Keyboard</a></li>
<li><a href="/students/iwasaki/mac/macports.html">MacPorts</a></li>
<li><a href="/students/iwasaki/mac/quicklook.html">QuickLook</a></li>
<li><a href="/students/iwasaki/mac/spotlight.html">Spotlight</a></li>
<li><a href="/students/iwasaki/mac/winebottler.html">WineBottler</a></li>
<li><a href="/students/iwasaki/mac/kotoeri.html">ことえり</a></li>
</ul>

<input type="checkbox" id="Lectures">
<label for="Lectures">Lectures</label>
<ul>
<li><a href="/students/iwasaki/lectures/verhoef_comm_ecol-11.html">Community Ecology 輪読会 11章</a></li>
<li><a href="/students/iwasaki/lectures/prml-11-1.html">PRML輪読会 11章1節</a></li>
<li><a href="/students/iwasaki/lectures/prml-2-1.html">PRML輪読会 2章前半</a></li>
<li><a href="/students/iwasaki/lectures/prml-3-4.html">PRML輪読会 3章4節</a></li>
<li><a href="/students/iwasaki/lectures/wakeley-2-2.html">Wakeley輪読会 2章2節</a></li>
</ul>

<input type="checkbox" id="Miscellaneous">
<label for="Miscellaneous">Miscellaneous</label>
<ul>
<li><a href="/students/iwasaki/misc/fonts.html">Fonts</a></li>
<li><a href="/students/iwasaki/misc/mailman.html">Mailman</a></li>
<li><a href="/students/iwasaki/misc/vnc.html">VNCによる画面共有</a></li>
<li><a href="/students/iwasaki/misc/virtualbox.html">VirtualBox</a></li>
</ul>
</nav>


<aside>
<h1><label for="inputsource">Page source</label></h1>
<input type="checkbox" id="inputsource">
<pre id="pagesource"><code class="language-markdown">
+++
title = "AppleScript"
+++

## Finder: Get file path

    tell application &#34;Finder&#34;
        set the clipboard to POSIX path of (the selection as alias)
    end tell

## iTunes Equalizer

イコライザを設定するスクリプト。
`band 1` が低音で `band 10` が高音。
下記の設定は Equal-loudness contour(等ラウドネス曲線) を考慮して
小さい音量でもシャカシャカせずそれなりのバランスで聴こえるようにした値。
音量やスピーカや好みによって調整し、別々のスクリプトとして保存しておくとよい:

    tell application &#34;iTunes&#34;
            tell EQ preset &#34;Manual&#34;
                    set band 1 to 1.5
                    set band 2 to 0.7
                    set band 3 to 0.3
                    set band 4 to 0.1
                    set band 5 to -0.1
                    set band 6 to -0.5
                    set band 7 to -1
                    set band 8 to -2
                    set band 9 to 0.3
                    set band 10 to 0.7
                    set preamp to 0
            end tell
    end tell

## osascript: スクリプトをターミナルで実行

スクリプトを置いたディレクトリにパスを通せれば楽なんだけど。できるのかな？:

    % osascript ${HOME}/Library/Scripts/Applications/Bibdesk/exportOOXML.scpt

## mi で選択中の文字列をターミナルで実行

    tell application &#34;mi&#34;
            tell document 1
                    set CommandLines to selection
            end tell
    end tell

    tell application &#34;Terminal&#34;
            activate
            ignoring application responses
                    do script with command CommandLines in window 1
            end ignoring
    end tell

## Bibdesk からGroupとTemplateを指定してExport

出力先、グループ名、テンプレートを最初の３行で指定し、Exportしたいライブラリを開いた状態で実行:

    set theOutFile to POSIX file &#34;/Users/Iwasaki/Presentations/20100118Thesis/items1.xml&#34;
    set theGroup to &#34;20100118 Thesis&#34;
    set theTemplateName to &#34;OOXML template&#34;

    using terms from application &#34;BibDesk&#34;
            tell application &#34;BibDesk&#34;
                    set theDoc to first document
                    set thePubs to publication of static group theGroup of theDoc
                    tell theDoc
                            export for thePubs using template theTemplateName to theOutFile
                    end tell
            end tell
    end using terms from

</code></pre>
</aside>

<footer>(ɔ) 2008 Watal M. Iwasaki</footer>
</div>

<script src="/students/iwasaki/js/highlight.pack.js"></script>
<script>
hljs.configure({languages: ["sh","c++","python","r","tex"]});
hljs.initHighlightingOnLoad();
</script>
</body>
</html>


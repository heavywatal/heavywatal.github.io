<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.16" />
<meta name="author" content="Watal M. Iwasaki">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic%7CUbuntu+Mono:400,400italic,700,700italic">
<link rel="stylesheet" href="/css/theme.css">
<link rel="stylesheet" href="/css/highlight.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/favicon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="/favicon-192x192.png" sizes="192x192">
<title>gcc - Watal M. Iwasaki</title>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em",
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['$$','$$']],
    processEnvironments: false
  }
});
MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i = 0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.classList.add('has-jax');
  }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-41178626-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>
<body><div class="container">
<header><h1><a href="/">
<img class="logo" src="/favicon-192x192.png" alt="岩嵜航">
Watal M. Iwasaki
</a></h1>
</header>

<main>
<article>
<header><h1><a href="">
gcc
</a></h1>
<ul class="tags">
<li><a href="/tags/c&#43;&#43;">c&#43;&#43;</a></li>
</ul>
</header>



<p><a href="http://gcc.gnu.org/"><a href="http://gcc.gnu.org/">http://gcc.gnu.org/</a></a></p>

<h2 id="usage">Usage</h2>

<p>直接コマンドを実行するなら:</p>

<pre><code>% g++ -g -Wall -Wextra -O3 main.cpp -o a.out
</code></pre>

<div class="note">
<p><a href="/dev/make.html">/dev/make</a></p>

<p>コンパイルの度にオプションとかファイルを打ち込むのは面倒なので
<code>Makefile</code> にルールを記述しといて <code>make</code> コマンドでビルドする。</p>

</div>


<h3 id="options">Options</h3>

<p><a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Invoking-GCC.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Invoking-GCC.html</a></p>

<p><strong>出力オプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Overall-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Overall-Options.html</a>
:</p>

<pre><code>`-c`
:   コンパイルするだけでリンクしない

`-o {file}`
:   出力先のファイル名を指定
</code></pre>

<p><strong>C/C++オプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/C-Dialect-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/C-Dialect-Options.html</a>
:</p>

<pre><code>`-std=c++11`
:   2011年のISO標準でコンパイルする。
    早くこれがデフォルトになればいいのに...。
    2014年予定の新標準も `-std=c++1y` で試験的に有効にできる。
    &lt;http://gcc.gnu.org/projects/cxx1y.html&gt;
</code></pre>

<p><strong>警告オプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Warning-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Warning-Options.html</a>
:</p>

<pre><code>`-Wall`
:   基本的な警告

`-Wextra`
:   Wallより厳しい警告

`-Werror`
:   警告をエラー扱いにする
</code></pre>

<p><strong>デバッグオプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Debugging-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Debugging-Options.html</a>
:</p>

<pre><code>`-g`
:   gdb で使えるデバッグ情報を埋め込む
</code></pre>

<p><strong>最適化オプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Optimize-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Optimize-Options.html</a>
:</p>

<pre><code>`-O1`
:   軽い最適化

`-O2`
:   プログラムサイズを大きくしない最適化をすべて実行

`-O3`
:   インライン展開なども行う

`-Os`
:   コードサイズが最小になるように
</code></pre>

<p><strong>プリプロセッサオプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Preprocessor-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Preprocessor-Options.html</a>
:</p>

<pre><code>`-D {name}`, `-D {name=definition}`
:   ソースコードで `#define` するのと同じようにマクロを定義する

`-I {dir}`, `-isystem {dir}`
:   `#include &lt;***&gt;` のインクルードパスの先頭に `{dir}` を追加。

`-iquote {dir}`
:   `#include &quot;***&quot;` のインクルードパスの先頭に `{dir}` を追加。

`-M`, `-MM`
:   ファイルの依存関係を書き出す。
    前者はシステムヘッダーを含み、後者は含まない。
</code></pre>

<p><strong>リンクオプション</strong> <a href="http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Link-Options.html">http://gcc.gnu.org/onlinedocs/gcc-4.9.0/gcc/Link-Options.html</a>
:</p>

<pre><code>`-l {library}`
:   リンクするライブラリを指定する。
    ファイル名が `libsfmt.a` のときは `-lsfmt`

`-L {dir}`
:   ライブラリのサーチパスを追加する
</code></pre>

<h2 id="installation">Installation</h2>

<p><a href="http://gcc.gnu.org/install/">http://gcc.gnu.org/install/</a></p>

<h3 id="mac">Mac</h3>

<p>Xcode についてくる <code>gcc-4.2</code> は
<code>gcc</code> の顔をした <code>clang</code> なので、
本当の <code>gcc</code> が欲しいときは別途インストールが必要。
<a href="/mac/homebrew.html">Homebrew</a><code>か</code><a href="/mac/macports.html">MacPorts</a> で入れるのが楽チン:</p>

<pre><code>% brew install gcc --without-multilib
</code></pre>

<h3 id="ubuntu">Ubuntu</h3>

<p>元から入ってるけど最新版をソースからインストールしたい。</p>

<ol>
<li><p>gmp, mpfr, mpc をインストール:</p>

<pre><code>% sudo apt-get install libgmp-dev libmpfr-dev libmpc-dev
</code></pre></li>

<li><p><code>--with-system-zlib</code> でビルドするには zlib が必要:</p>

<pre><code>% sudo apt-get install zlib1g-dev
</code></pre></li>

<li><p>システムに既に入ってる <code>gcc</code> の <code>configure</code> オプションを見る:</p>

<pre><code>% gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.8.2-19ubuntu1' --with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.8 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-libmudflap --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.8.2 (Ubuntu 4.8.2-19ubuntu1)
</code></pre></li>

<li><p>それを参考にして <code>configure</code></p>

<ul>
<li><code>--enable-languages</code> は使う言語だけに</li>
<li><code>--prefix</code> は <code>/usr/local</code></li>
<li>既存のバージョンとごっちゃになるのを避けるため
<code>--program-suffix</code> を設定</li>
<li>他言語サポートは不要なので <code>--disable-nls</code></li>
<li><code>--disable-multilib</code> を付けないと
<code>fatal error: gnu/stubs-32.h: No such file or directory. stub-32.h</code>
などと怒られて止まる</li>
</ul>

<!-- -->

<pre><code>% wget -O- http://ftp.gnu.org/gnu/gcc/gcc-4.9.1/gcc-4.9.1.tar.bz2 | tar xj
% mkdir build
% cd build/
% ../gcc-4.9.1/configure --enable-languages=c,c++,go,fortran --prefix=/usr/local --program-suffix=-4.9 --enable-shared --enable-linker-build-id --without-included-gettext --enable-threads=posix --disable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-libmudflap --enable-plugin --with-system-zlib --disable-browser-plugin --enable-gtk-cairo --with-arch-directory=amd64 --enable-multiarch --disable-werror --with-abi=m64 --disable-multilib --with-tune=core2 --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
</code></pre></li>

<li><p>コンパイル。ただしデフォルトではコンパイラオプションが <code>-g O2</code>
となっていて膨大なデバッグシンボルがついた状態で出来上がってしまうらしいので、
オプションを上書きしてそれを回避する。:</p>

<pre><code>% make BOOT_CFLAGS=&quot;-O2&quot; CFLAGS=&quot;-O2&quot; CXXFLAGS=&quot;-O2&quot; bootstrap
</code></pre>

<p><code>fatal error: bits/predefs.h: No such file or directory</code>
って怒られたら:</p>

<pre><code>% sudo apt-get install libc6-dev-i386
</code></pre>

<p><code>/usr/bin/ld: cannot find crti.o: No such file or directory</code>
って怒られたら:</p>

<pre><code>% sudo ln -s /usr/lib/x86_64-linux-gnu /usr/lib64
</code></pre></li>

<li><p>インストール。の前に <code>make DESTDIR=$HOME/tmp/gcc-test install</code>
などとしてテストするといいらしい。 :</p>

<pre><code>% sudo make install

# ディスクレスクラスタの場合、子ノードにもインストール
% sudo make DESTDIR=/nfsroot install
</code></pre></li>
</ol>

</article>
</main>

<nav class="menu">

<div><a href="/about.html">About</a></div>


<div><a href="/research.html">Research Interests</a></div>


<input type="checkbox" id="menu-rstats">
<label for="menu-rstats">R stats</label>
<ul>
<li><a href="/rstats/intro.html">R自学自習の基礎知識</a></li>
<li><a href="/rstats/config.html">R環境設定</a></li>
<li><a href="/rstats/programming.html">RプログラミングTips</a></li>
<li><a href="/rstats/ggplot2.html">ggplot2</a></li>
<li><a href="/rstats/dplyr.html">dplyr</a></li>
<li><a href="/rstats/tidyr.html">tidyr</a></li>
<li><a href="/rstats/readr.html">readr</a></li>
<li><a href="/rstats/stringr.html">stringr</a></li>
<li><a href="/rstats/devtools.html">devtools</a></li>
<li><a href="/rstats/bioconductor.html">Bioconductor</a></li>
<li><a href="/rstats/rtracklayer.html">rtracklayer</a></li>
<li><a href="/rstats/biomart.html">biomaRt</a></li>
<li><a href="/rstats/ggbio.html">ggbio</a></li>
<li><a href="/rstats/edger.html">edgeR</a></li>
<li><a href="/rstats/topgo.html">topGO</a></li>
<li><a href="/rstats/rgl.html">rgl</a></li>
<li><a href="/rstats/rjags.html">rjags</a></li>
<li><a href="/rstats/plyr.html">plyr</a></li>
<li><a href="/rstats/reshape2.html">reshape2</a></li>
</ul>

<input type="checkbox" id="menu-python">
<label for="menu-python">Python</label>
<ul>
<li><a href="/python/install.html">Installation</a></li>
<li><a href="/python/pip.html">pip</a></li>
<li><a href="/python/ipython.html">IPython</a></li>
<li><a href="/python/biopython.html">BioPython</a></li>
<li><a href="/python/egglib.html">EggLib</a></li>
<li><a href="/python/scipy.html">NumPy, SciPy</a></li>
<li><a href="/python/pyqt.html">PyQt</a></li>
<li><a href="/python/copy.html">copy</a></li>
<li><a href="/python/matplotlib.html">matplotlib &#43; seaborn</a></li>
<li><a href="/python/rpy2.html">rpy2</a></li>
</ul>

<input type="checkbox" id="menu-cxx" checked>
<label for="menu-cxx" class="active">C&#43;&#43;</label>
<ul>
<li><a href="/cxx/boost.html">Boost</a></li>
<li><a href="/cxx/getopt.html">C&#43;&#43;コマンドライン引数</a></li>
<li><a href="/cxx/speed.html">C&#43;&#43;高速化</a></li>
<li><a href="/cxx/clang.html">clang / llvm</a></li>
<li class="active"><a href="/cxx/gcc.html">gcc</a></li>
<li><a href="/cxx/random.html">擬似乱数生成器</a></li>
</ul>

<input type="checkbox" id="menu-bio">
<label for="menu-bio">Biology</label>
<ul>
<li><a href="/bio/blast.html">BLAST</a></li>
<li><a href="/bio/dnasp.html">DnaSP</a></li>
<li><a href="/bio/emboss.html">EMBOSS</a></li>
<li><a href="/bio/ensembl.html">Ensembl</a></li>
<li><a href="/bio/gene_ontology.html">Gene Ontology</a></li>
<li><a href="/bio/meme.html">MEME</a></li>
<li><a href="/bio/mrbayes.html">MrBayes</a></li>
<li><a href="/bio/paml.html">PAML</a></li>
<li><a href="/bio/popgen.html">Population Genetics</a></li>
<li><a href="/bio/repeatmasker.html">RepeatMasker</a></li>
<li><a href="/bio/samtools.html">SAMtools</a></li>
<li><a href="/bio/stochastic_process.html">Stochastic Process</a></li>
<li><a href="/bio/dadi.html">dadi</a></li>
<li><a href="/bio/mathmorph.html">数理形態学</a></li>
<li><a href="/bio/linear_algebra.html">線形代数</a></li>
<li><a href="/bio/complexnetwork.html">複雑ネットワーク</a></li>
<li><a href="/bio/nig.html">遺伝研スパコン</a></li>
<li><a href="/bio/motif.html">配列モチーフ探索</a></li>
</ul>

<input type="checkbox" id="menu-dev">
<label for="menu-dev">Developer Tools</label>
<ul>
<li><a href="/dev/etc.html">/etc</a></li>
<li><a href="/dev/atom.html">Atom</a></li>
<li><a href="/dev/emacs.html">Emacs</a></li>
<li><a href="/dev/git.html">Git</a></li>
<li><a href="/dev/hugo.html">Hugo</a></li>
<li><a href="/dev/mercurial.html">Mercurial</a></li>
<li><a href="/dev/mysql.html">MySQL</a></li>
<li><a href="/dev/qt.html">Qt</a></li>
<li><a href="/dev/sh.html">Shell Script</a></li>
<li><a href="/dev/torque.html">TORQUE</a></li>
<li><a href="/dev/tex.html">TeX</a></li>
<li><a href="/dev/autotools.html">autoconf, automake</a></li>
<li><a href="/dev/make.html">make</a></li>
<li><a href="/dev/mount.html">mount</a></li>
<li><a href="/dev/nano.html">nano</a></li>
<li><a href="/dev/rsync.html">rsync</a></li>
<li><a href="/dev/ssh.html">ssh</a></li>
<li><a href="/dev/sshfs.html">sshfs</a></li>
<li><a href="/dev/tmux.html">tmux</a></li>
<li><a href="/dev/vi.html">vi</a></li>
<li><a href="/dev/zsh.html">zsh</a></li>
<li><a href="/dev/nohup.html">プロセス管理</a></li>
<li><a href="/dev/devenv.html">開発環境</a></li>
</ul>

<input type="checkbox" id="menu-linux">
<label for="menu-linux">Linux</label>
<ul>
<li><a href="/linux/centos.html">CentOS 6.5</a></li>
<li><a href="/linux/japanese.html">Linux日本語環境</a></li>
<li><a href="/linux/apt.html">apt/dpkg</a></li>
<li><a href="/linux/ufw.html">ufw</a></li>
</ul>

<input type="checkbox" id="menu-mac">
<label for="menu-mac">Mac</label>
<ul>
<li><a href="/mac/applescript.html">AppleScript</a></li>
<li><a href="/mac/homebrew.html">Homebrew</a></li>
<li><a href="/mac/keyboard.html">Keyboard</a></li>
<li><a href="/mac/command.html">Mac Command</a></li>
<li><a href="/mac/macports.html">MacPorts</a></li>
<li><a href="/mac/quicklook.html">QuickLook</a></li>
<li><a href="/mac/spotlight.html">Spotlight</a></li>
<li><a href="/mac/winebottler.html">WineBottler</a></li>
<li><a href="/mac/kotoeri.html">ことえり</a></li>
</ul>

<input type="checkbox" id="menu-lectures">
<label for="menu-lectures">Lectures</label>
<ul>
<li><a href="/lectures/verhoef_comm_ecol-11.html">Community Ecology 輪読会 11章</a></li>
<li><a href="/lectures/prml-11-1.html">PRML輪読会 11章1節</a></li>
<li><a href="/lectures/prml-2-1.html">PRML輪読会 2章前半</a></li>
<li><a href="/lectures/prml-3-4.html">PRML輪読会 3章4節</a></li>
<li><a href="/lectures/wakeley-2-2.html">Wakeley輪読会 2章2節</a></li>
</ul>

<input type="checkbox" id="menu-misc">
<label for="menu-misc">Miscellaneous</label>
<ul>
<li><a href="/misc/fonts.html">Fonts</a></li>
<li><a href="/misc/mailman.html">Mailman</a></li>
<li><a href="/misc/vnc.html">VNCによる画面共有</a></li>
<li><a href="/misc/virtualbox.html">VirtualBox</a></li>
</ul>

<div><a href="/tags">Tags</a></div>

</nav>




<footer>(ɔ) 2008 岩嵜航 Watal M. Iwasaki</footer>
</div>

<script src="/js/highlight.pack.js"></script>
<script>
hljs.configure({languages: ["sh","c++","python","r","tex"]});
hljs.initHighlightingOnLoad();
</script>
</body>
</html>

